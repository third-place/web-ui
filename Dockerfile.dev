FROM node:21.6.2-alpine3.18 AS build

ARG VITE_USER_SERVICE
ARG VITE_COMMUNITY_SERVICE
ARG VITE_NOTIFICATION_SERVICE
ARG VITE_IMAGE_SERVICE
ARG VITE_IMAGE_HOST

ENV VITE_USER_SERVICE=${VITE_USER_SERVICE}
ENV VITE_COMMUNITY_SERVICE=${VITE_COMMUNITY_SERVICE}
ENV VITE_NOTIFICATION_SERVICE=${VITE_NOTIFICATION_SERVICE}
ENV VITE_IMAGE_SERVICE=${VITE_IMAGE_SERVICE}
ENV VITE_IMAGE_HOST=${VITE_IMAGE_HOST}

WORKDIR /app
COPY . .
RUN npm install -g pnpm
RUN pnpm install --frozen-lockfile

EXPOSE 5173

CMD ["pnpm", "dev"]
